# Threat Vulnerability Analyzer (Preview version)

The Fraud Protection Threat Vulnerability Analyzer (Preview) tool is provided to you as a Preview service under terms and conditions described in the Microsoft Online Service Terms. The Threat Vulnerability Analyzer is a tool that allows customers to analyze Account Protection session data, investigate threat and fraud attack at session level, and make informed operational decisions such as setting the score threshold, segmenting threat traffic, estimating score threshold impact, analyzing abusive traffic pattern, and validating ML score performance. The interactive tool provides intelligence on various dimensions including geolocation, device configuration, IP, reason code, and etc.

The Threat Vulnerability Analyzer is an interactive report tool built on the Microsoft Power BI platform. Customers can use this tool to analyze threat vulnerability for account protection in their online systems by applying various filters, changing the score threshold, and viewing an analysis of historical trend.

The Threat Vulnerability Analyzer report refreshes every 24 hours with the latest Account Protection sessions. The time stamp in the report displays the UTC refresh time for the report. The TVA retains account login and account creation sessions from past 4 weeks and limiting to 4 million login sessions. Reports may show empty results due to insufficient data.

The Threat Vulnerability Analyzer is composed of the following report tabs:

- **Summary**, which visualize key metrics, distributions, and trends at high level.

- **Hourly Heat Map**, which visualize hourly distribution of the volume, average bot and risk score to identify seasonality and anomaly.

- **Week Over Week**, it gives comparison between selected date and rest of the dates on selected day of week to identify trends and fraud patterns.

- **Day Over Day**, it gives comparison between selected date and past 6 days to identify trends and fraud patterns.

- **Location Distribution**, which visualizes volume distribution and relative volume on selected location comparing to total traffic at country, state, or city level.

- **Score Distribution**, which visualizes bot and risk score distribution and cumulative percentage to optimize score threshold and estimate impact.

- **Reason Code**, it slices the traffic by bot and risk model reason code and help the customer understand most significant factors provided by the model.

- **Status**, it visualizes score distribution by session status and status changes over time, which validates the efficacy of the score against the given session status.

- **Label**, it visualizes score distribution by label state and label changes over time, which validates the efficacy of the score against the given label state.

- **Device Configuration**, which shows traffic distribution by device configuration properties, such as Operating System and Browser.

- **IP Deep Dive**, provides deep dive analysis on IP addresses with high volume and understands trend of IP addresses at selected percentile.

- **Device ID Level**, provides deep dive analysis on device ID with many shared users and identify risky devices at selected percentile.

- **Session details**, allows drill-through from any report to view session details including device and location data, user can apply filters to segment out sessions for deep dive investigation.

## Summary

Like most pages in the Threat Vulnerability Analyzer, customers can configure the filter and granularity options on top of the page. Customers can also expand the hidden filter pane for advanced filters. Please refer to the Appendix on filters and options available in the TVA.

Summary report shows high level metrics such as volume, % of no geolocation, average bot score and average risk score to provide insights.

Charts available on summary report includes:

-   Volume by location in a map layout

-   Top 10 volume location by bot score and risk score category, which will render based on the selected location granularity option.

-   Volume, average bot & risk score by period, which shows time series of the key metrics based on the selected date granularity.

-   Volume for not approved status by period, which shows not approved status based on the selected date granularity.

-   Volume for labels by period, which shows not approved label based on the selected date granularity.

## Hourly Heat Map

Hourly Heat Map visualizes hourly distribution of the volume, average bot and risk score to identify seasonality and anomaly. For example, an unusual volume spike or high score at 1AM may indicate fraud attack. Hourly Heat Map also shows high level metrics such as volume, average bot score and average risk score to provide insights.

Charts available on Hourly Heat Map includes:

-   Volume by day of week/hour of day, which shows volume at each hour of every day of week, the higher the volume the darker the color shade is for the given hour of day in a week.

-   Average bot score by day of week/hour of day, which shows average bot score at each hour of every day of week, the higher the bot score the darker the color shade is for the given hour of day in a week.

-   Average risk score by day of week/hour of day, which shows average risk score at each hour of every day of week, the higher the risk score the darker the color shade is for the given hour of day in a week.

## Week Over Week

Week Over Week gives comparison between selected date and rest of the dates on selected day of week to validate if weekly pattern holds and identify trends and fraud patterns. For example, if a certain day has unusual high volume or high score comparing to the prior weeks it indicates a potential threat attack.

Charts available on Week Over Week includes:

-   Hourly volume by day of week, which shows hourly volume and compare selected date with same day of the week for up to 4 weeks prior.

-   Hourly average bot score by day of week, which shows hourly average bot score and compare selected date with same day of the week for up to 4 weeks prior.

-   Hourly average risk score by day of week, which shows hourly average risk score and compare selected date with same day of the week for up to 4 weeks prior.

## Day Over Day

Day Over Day gives comparison between selected date and past 6 days to validate if daily pattern holds and identify trends and fraud patterns. For example, if a certain hour in the day has unusual high volume or high score comparing to the prior days it indicates a potential threat attack.

Charts available on Day Over Day includes:

-   Hourly volume by day, which shows hourly volume and compare selected date with past 6 days.

-   Hourly average bot score by day, which shows hourly average bot score and compare selected date with past 6 days.

-   Hourly average risk score by day of week, which shows hourly average risk score and compare selected date with past 6 days.

## Location Distribution

Location Distribution visualizes volume distribution and relative volume on selected location comparing to total traffic at country, state, or city level. For example, a sudden increase of volume from certain location may indicates a potential attack. Location Distribution also shows high level metrics such as total volume and populated rate to provide quick overview.

Charts available on Location Distribution includes:

-   Top 10 country volume distribution and populate rate, which shows countries/regions with highest volume distribution and populated rate change over time.

-   Top 10 state volume distribution, which shows states/provinces with highest volume distribution over time.

-   Top 10 location volume % of total traffic, which shows top location based on selected granularity (city, state/province, or country/region) volume percentage over time.

-   Top 10 location volume, which shows top location based on selected granularity (city, state/province, or country/region) volume over time.

## Score Distribution

Score Distribution visualizes bot and risk score distribution and cumulative percentage to optimize score threshold and estimate impact. For example, at certain score bin we can see from the cumulative percentage chart what will be the percentage of total traffic could be rejected by applying the score threshold. The Transaction period volume by bot and risk score bin provides a view to identify trends and anomaly on the score.

Charts available on Score Distribution includes:

-   Volume and cumulative percentage by bot score bin, which shows volume and cumulative percentage by bot score bin, including special score defined in the Appendix.

-   Volume and cumulative percentage by risk score bin, which shows volume and cumulative percentage by risk score bin, including special score defined in the Appendix.

-   Transaction period volume by bot score bin, which shows volume distribution by bot score bin over time, based on selected date granularity.

-   Transaction period volume by risk score bin, which shows volume distribution by risk score bin over time, based on selected date granularity.

-   Table of transaction period including volume, average bot score and average risk score, based on selected date granularity.

## Reason Code

Reason Code slices the traffic by bot and risk model reason code and help the customer understand most significant factors provided by the model. Customers can easily identify the reason codes have most volume and the score distribution for the reason code.

Charts available on Reason Code includes:

-   Volume by bot score bin and reason code, which shows top reason code provided by the bot model. The volume also shows score bin distribution and customers can apply filters on bot score reason code to dive deep.

-   Volume by risk score bin and reason code, which shows top reason code provided by the risk model. The volume also shows score bin distribution and customers can apply filters on risk score reason code to dive deep.

-   Volume percentage by bot score bin and reason code, which shows volume percentage for bot reason code.

-   Volume percentage by risk score bin and reason code, which shows volume percentage for risk reason code.

## Status

Status visualizes score distribution by session status and status changes over time, which validates the efficacy of the score against the given the session status. For example, if the sessions with high risk score have more rejected status comparing to sessions with low risk score, it indicates that the risk model is effective in identifying suspicious sessions.

Charts available on Status includes:

-   Status distribution, a table of statuses and their volume, average bot score and average risk score.

-   Status distribution & average score by period, which shows approved or rejected sessions' average bot and risk score change over time, based on selected date granularity.

-   Status rate by period, which shows percentage of each status over time, based on selected date granularity.

-   Bot score cumulative & status, which shows volume and cumulative percentage for each status by bot score bin.

-   Risk score cumulative & status, which shows volume and cumulative percentage for each status by risk score bin.

-   Transaction period volume by bot score bin, which shows volume distribution by bot score bin for each transaction period and status.

-   Transaction period volume by risk score bin, which shows volume distribution by risk score bin for each transaction period and status.

## Label

Label visualizes score distribution by session status and status changes over time, which validates the efficacy of the score against the given the label state. For example, if the sessions with high risk score have more session identified as fraud comparing to sessions with low risk score, it indicates that the risk model is effective in identifying fraudulent sessions.

Charts available on Label includes:

-   Status distribution, a table of label states and their volume, average bot score and average risk score.

-   Status distribution & average score by period, which shows fraud or non-fraud sessions' average bot and risk score change over time, based on selected date granularity.

-   Status rate by period, which shows percentage of each label state over time, based on selected date granularity.

-   Bot score cumulative & status, which shows volume and cumulative percentage for each label state by bot score bin.

-   Risk score cumulative & status, which shows volume and cumulative percentage for each label state by risk score bin.

-   Transaction period volume by bot score bin, which shows volume distribution by bot score bin for each transaction period and label state.

-   Transaction period volume by risk score bin, which shows volume distribution by risk score bin for each transaction period and label state.

## Device Configuration

Device Configuration shows traffic distribution by device configuration properties, such as Operating System and Browser. It provides insights on trends or anomaly if certain OS family or browser family has unusual change in percentage in the traffic.

Charts available on Device Configuration includes:

-   Operating system family populated rate and volume distribution, which shows OS family populated rate and distribution change over time, based on selected date granularity.

-   Operating system populated rate and volume distribution, which shows OS populated rate and distribution change over time, based on selected date granularity.

-   Browser family populated rate and volume distribution, which shows Browser family populated rate and distribution change over time, based on selected date granularity.

## IP Deep Dive

IP Deep Dive provides deep dive analysis on IP addresses with high volume and understands trend of IP addresses at selected percentile. It provides list of IP addresses that have high volume and shows volume per IP over time to identify potential attack.

Charts available on IP Deep Dive includes:

-   Top 20 volume IP addresses by location and average bot and risk score, shows a plot of top 20 IP addresses by average bot and risk score, the bigger the size of the bubble the big volume is.

-   Volume by location, which shows a world map of traffic origin, the darker the shade the more volume from that area.

-   List of IP addresses and their volume and distinct user count for each IP address.

-   Volume per IP address at selected percentile, which shows number of sessions per IP above selected percentile over time.

-   Percentile of volume per IP address, which shows number of sessions per IP at each given percentile.

## Device ID Level

Device ID Level provides deep dive analysis on device ID with many shared users and identify risky devices at selected percentile. It provides list of device IDs that have high distinct user count and shows distinct user count per device ID by percentile to identify potential attack.

Charts available on Device ID Level includes:

-   List of Device ID and their distinct user count for each Device ID.

-   Distinct user count per Device ID by percentile.

## Session Details

Session Details allows drill-through from any report to view session details including device and location data, user can apply filters to segment out sessions for deep dive investigation.

Charts available on Session Details includes:

-   Volume by location, which shows world map of session volume.

-   Volume, average bot and risk scores by date.

-   List of sessions and detail metadata about their time, location, IP address, user account, device configuration, network configuration, bot and risk score, status and reason.

## Appendix

### Score Definition

-   -10: Session not covered by model.

-   -9: Device attributes are invalid.

-   -1: Internal exceptions.

-   0: Score range from 0 to 99.

-   999: Suspicious user agent found

OR missing device information

OR Geo lookup failure

OR the highest model score

### Report Filters and Options

-   Event type: Account creation or account login.

-   Challenge type: input from status API.

-   Reason type: input from status API.

-   Date granularity: Daily, Weekly, Monthly.

-   Location granularity: City, State/Province, Country/Region.

-   Country/Region, State/Province, City.

-   Status.

-   Label state.

-   Date range. Customers can use the slider or date picker to set the date range.

-   Bot score: -10 to 999

-   Risk score: -10 to 999

### Hidden filter pane

-   ASN

-   Bot reason code

-   Browser family

-   Browser language

-   Browser user agent

-   Browser version

-   Email domain

-   IP address

-   Network hop count

-   Operating system

-   Operating system family

-   Risk reason code
